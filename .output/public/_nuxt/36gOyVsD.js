import{g as k,r as y,j as U,y as A,c as o,a as e,k as m,t as x,F as S,x as V,s as C,o as d,m as b,v as h,z as p,A as z,p as g}from"./DQwChrcD.js";const F={class:"p-6 max-w-7xl mx-auto"},N={key:0,class:"text-gray-600"},D={key:1,class:"text-red-600"},M={key:2,class:"min-w-full bg-white rounded-lg overflow-hidden shadow-md text-sm"},$={class:"px-4 py-2"},B=["onUpdate:modelValue","readonly"],E={class:"px-4 py-2"},L=["onUpdate:modelValue","readonly"],O={class:"px-4 py-2"},I=["onUpdate:modelValue","disabled"],P={class:"px-4 py-2"},R={class:"px-4 py-2"},T={class:"px-4 py-2 space-x-2"},j=["onClick","disabled"],q=["onClick","disabled"],H={key:3,class:"text-gray-600 italic"},K=k({__name:"users",setup(G){var _;const u=y([]),i=y(!1),r=y(""),c=((_=U().user)==null?void 0:_._id)||"",f=async()=>{i.value=!0,r.value="";try{const a=await $fetch("/api/user/list",{credentials:"include",headers:C(["cookie"])});a.success?u.value=a.users:r.value="Failed to load users."}catch(a){r.value="An error occurred while fetching users.",console.error("[SuperAdmin] Fetch error:",a)}finally{i.value=!1}},v=a=>{a.disabled=!a.disabled},w=async a=>{var t;const s={userId:a._id};a.name&&(s.name=a.name),a.email&&(s.email=a.email),a.role&&(s.role=a.role),typeof a.disabled=="boolean"&&(s.disabled=a.disabled);try{await $fetch("/api/user/update",{method:"POST",body:s}),alert("User updated successfully.")}catch(n){alert(((t=n==null?void 0:n.data)==null?void 0:t.message)||"Failed to update user.")}};return A(f),(a,s)=>(d(),o("div",F,[s[2]||(s[2]=e("h1",{class:"text-2xl font-bold mb-4"},"Manage Users",-1)),s[3]||(s[3]=e("p",{class:"mb-4 text-gray-600"},"List of all users across the platform with admin controls.",-1)),i.value?(d(),o("div",N,"Loading users...")):m("",!0),r.value?(d(),o("div",D,x(r.value),1)):m("",!0),!i.value&&u.value.length?(d(),o("table",M,[s[1]||(s[1]=e("thead",{class:"bg-gray-100 border-b text-gray-800"},[e("tr",null,[e("th",{class:"text-left px-4 py-2"},"Name"),e("th",{class:"text-left px-4 py-2"},"Email"),e("th",{class:"text-left px-4 py-2"},"Role"),e("th",{class:"text-left px-4 py-2"},"Organization"),e("th",{class:"text-left px-4 py-2"},"Status"),e("th",{class:"text-left px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(d(!0),o(S,null,V(u.value,t=>{var n;return d(),o("tr",{key:t._id,class:"border-b hover:bg-gray-50"},[e("td",$,[b(e("input",{"onUpdate:modelValue":l=>t.name=l,type:"text",class:"border px-2 py-1 w-full rounded",readonly:t._id===p(c)},null,8,B),[[h,t.name]])]),e("td",E,[b(e("input",{"onUpdate:modelValue":l=>t.email=l,type:"email",class:"border px-2 py-1 w-full rounded",readonly:t._id===p(c)},null,8,L),[[h,t.email]])]),e("td",O,[b(e("select",{"onUpdate:modelValue":l=>t.role=l,class:"border rounded px-2 py-1",disabled:t._id===p(c)},s[0]||(s[0]=[e("option",{value:"super_admin"},"Super Admin",-1),e("option",{value:"platform_admin"},"Platform Admin",-1),e("option",{value:"organization_admin"},"Organization Admin",-1),e("option",{value:"user"},"User",-1)]),8,I),[[z,t.role]])]),e("td",P,x(((n=t.organization)==null?void 0:n.name)||"N/A"),1),e("td",R,[e("span",{class:g(["text-xs font-semibold px-2 py-1 rounded",t.disabled?"bg-red-100 text-red-700":"bg-green-100 text-green-700"])},x(t.disabled?"Disabled":"Active"),3)]),e("td",T,[e("button",{onClick:l=>v(t),class:g(["text-sm text-white px-3 py-1 rounded",t.disabled?"bg-green-600 hover:bg-green-700":"bg-yellow-500 hover:bg-yellow-600"]),disabled:t._id===p(c)},x(t.disabled?"Enable":"Disable"),11,j),e("button",{onClick:l=>w(t),class:"text-sm bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded",disabled:t._id===p(c)}," Save ",8,q)])])}),128))])])):m("",!0),!i.value&&!u.value.length?(d(),o("p",H,"No users found.")):m("",!0)]))}});export{K as default};
