import{g as I,r,q as N,c as l,a as e,k,m as w,v as P,A as $,t as o,z as y,F as T,x as L,s as M,o as n}from"./DQwChrcD.js";import{u as O}from"./2qLusjlS.js";const V={class:"max-w-6xl mx-auto py-10 px-4"},q={class:"mb-8 p-4 bg-white shadow rounded-xl space-y-4 border border-gray-200"},B={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},D={key:0,class:"text-green-600 text-sm mt-2"},E={key:1,class:"text-red-600 text-sm mt-2"},U={key:0,class:"text-gray-600"},H={key:1,class:"text-red-600 font-semibold"},J={key:2},Y={class:"w-full border-collapse bg-white shadow-md rounded-lg overflow-hidden"},j={class:"py-2 px-4"},G={class:"py-2 px-4 capitalize"},K={class:"py-2 px-4"},Q={class:"py-2 px-4 capitalize"},W={class:"py-2 px-4"},X={class:"py-2 px-4 space-x-2"},Z=["onClick","disabled"],ee=["onClick","disabled"],te={key:3,class:"text-gray-500"},oe=I({__name:"invites",async setup(se){let u,g;const c=r(""),v=r("organization_admin"),i=r(""),d=r(""),p=r(null),m=r(null),{data:_,error:C,pending:S,refresh:x}=([u,g]=N(()=>O("/api/platform/invites",{credentials:"include",headers:M()},"$YNv8LT3JNr")),u=await u,g(),u),R=async()=>{var a;i.value="",d.value="";try{await $fetch("/api/platform/invite",{method:"POST",credentials:"include",body:{email:c.value,role:v.value}}),i.value="Invitation sent successfully.",c.value="",v.value="organization_admin",await x()}catch(t){d.value=((a=t==null?void 0:t.data)==null?void 0:a.message)||"Failed to send invitation."}},z=async a=>{p.value=a,i.value="",d.value="";try{await $fetch("/api/platform/invite/resend",{method:"POST",body:{inviteId:a}}),i.value="Invite resent successfully.",await x()}catch{d.value="Failed to resend invite."}finally{p.value=null}},A=async a=>{m.value=a,i.value="",d.value="";try{await $fetch("/api/platform/invite/revoke",{method:"POST",body:{inviteId:a}}),i.value="Invite revoked successfully.",await x()}catch{d.value="Failed to revoke invite."}finally{m.value=null}};return(a,t)=>{var b,h;return n(),l("div",V,[t[7]||(t[7]=e("h1",{class:"text-3xl font-bold text-gray-800 mb-6"},"Platform Invitations",-1)),e("div",q,[t[5]||(t[5]=e("h2",{class:"text-lg font-semibold"},"Send New Platform Invitation",-1)),e("div",B,[e("div",null,[t[2]||(t[2]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),type:"email",class:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"admin@company.com",required:""},null,512),[[P,c.value]])]),e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Role",-1)),w(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),class:"w-full border border-gray-300 rounded px-3 py-2"},t[3]||(t[3]=[e("option",{value:"organization_admin"},"Organization Admin",-1),e("option",{value:"user"},"Regular User",-1)]),512),[[$,v.value]])])]),e("button",{onClick:R,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded transition"}," Send Invite "),i.value?(n(),l("p",D,o(i.value),1)):k("",!0),d.value?(n(),l("p",E,o(d.value),1)):k("",!0)]),y(S)?(n(),l("div",U,"Loading invites...")):y(C)?(n(),l("div",H,"Failed to load invites.")):(h=(b=y(_))==null?void 0:b.invites)!=null&&h.length?(n(),l("div",J,[e("table",Y,[t[6]||(t[6]=e("thead",{class:"bg-gray-100 text-left"},[e("tr",null,[e("th",{class:"py-2 px-4"},"Email"),e("th",{class:"py-2 px-4"},"Role"),e("th",{class:"py-2 px-4"},"Platform"),e("th",{class:"py-2 px-4"},"Status"),e("th",{class:"py-2 px-4"},"Created At"),e("th",{class:"py-2 px-4"},"Actions")])],-1)),e("tbody",null,[(n(!0),l(T,null,L(y(_).invites,s=>{var f;return n(),l("tr",{key:s._id,class:"border-b hover:bg-gray-50"},[e("td",j,o(s.email),1),e("td",G,o(s.role.replace(/_/g," ")),1),e("td",K,o(((f=s.platform)==null?void 0:f.name)||"N/A"),1),e("td",Q,o(s.status),1),e("td",W,o(new Date(s.createdAt).toLocaleString()),1),e("td",X,[e("button",{onClick:F=>z(s._id),class:"text-blue-600 text-sm hover:underline",disabled:p.value===s._id},o(p.value===s._id?"Resending...":"Resend"),9,Z),e("button",{onClick:F=>A(s._id),class:"text-red-600 text-sm hover:underline",disabled:m.value===s._id},o(m.value===s._id?"Revoking...":"Revoke"),9,ee)])])}),128))])])])):(n(),l("div",te,"No invitations found."))])}}});export{oe as default};
