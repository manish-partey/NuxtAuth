import{g as z,r,y as _,c as s,a,k as P,m as f,v as S,A as c,F as b,x as y,t as v,l as O,n as h,o as i}from"./DQwChrcD.js";const A={class:"p-6 max-w-lg mx-auto"},T=["disabled"],V=["value"],q=["value"],C={key:0,class:"text-red-600"},D=["disabled"],N=z({__name:"create-organization",setup(F){const g=h(),d=r(""),u=r(""),m=r(""),n=r(""),p=r(!1),o=r([]),x=["grocery_store","college_department","clinic","other"];async function w(){try{const l=await $fetch("/api/platform/list",{credentials:"include"});Array.isArray(l.platforms)?o.value=l.platforms.filter(e=>e._id&&e.name):Array.isArray(l)?o.value=l.filter(e=>e._id&&e.name):(console.warn("[Platform Dropdown] Unexpected response:",l),o.value=[])}catch(l){console.error("[Platform Fetch Error]",l),o.value=[]}}_(w);async function k(){if(n.value="",!d.value.trim()||!u.value||!m.value){n.value="Please fill all required fields.";return}p.value=!0;try{await $fetch("/api/org/create",{method:"POST",credentials:"include",body:{name:d.value.trim(),platformId:u.value,type:m.value}}),g.push("/superadmin/organizations")}catch{n.value="Failed to create organization."}finally{p.value=!1}}return(l,e)=>(i(),s("div",A,[e[8]||(e[8]=a("h1",{class:"text-2xl font-bold mb-6"},"Create New Organization",-1)),a("form",{onSubmit:O(k,["prevent"]),class:"space-y-4"},[a("div",null,[e[3]||(e[3]=a("label",{for:"name",class:"block font-semibold mb-1"},"Organization Name",-1)),f(a("input",{id:"name",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),placeholder:"e.g., Downtown Grocery Store",class:"w-full border border-gray-300 rounded px-3 py-2",required:""},null,512),[[S,d.value]])]),a("div",null,[e[5]||(e[5]=a("label",{for:"platform",class:"block font-semibold mb-1"},"Parent Platform",-1)),f(a("select",{id:"platform","onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),class:"w-full border border-gray-300 rounded px-3 py-2",required:"",disabled:!o.value.length},[e[4]||(e[4]=a("option",{value:"",disabled:""},"Select Platform",-1)),(i(!0),s(b,null,y(o.value,t=>(i(),s("option",{key:t._id,value:t._id},v(t.name),9,V))),128))],8,T),[[c,u.value]])]),a("div",null,[e[7]||(e[7]=a("label",{for:"type",class:"block font-semibold mb-1"},"Organization Type",-1)),f(a("select",{id:"type","onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),class:"w-full border border-gray-300 rounded px-3 py-2",required:""},[e[6]||(e[6]=a("option",{value:"",disabled:""},"Select Type",-1)),(i(),s(b,null,y(x,t=>a("option",{key:t,value:t},v(t.replace(/_/g," ")),9,q)),64))],512),[[c,m.value]])]),n.value?(i(),s("div",C,v(n.value),1)):P("",!0),a("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",disabled:p.value}," Create Organization ",8,D)],32)]))}});export{N as default};
