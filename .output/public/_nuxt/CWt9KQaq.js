import{g as _,r as n,y as h,c as r,a as e,k as g,t as a,F as f,x as m,o}from"./DQwChrcD.js";const x={class:"p-6"},k={key:0,class:"text-gray-500"},N={key:1,class:"text-red-600"},P={key:2,class:"w-full border-collapse border border-gray-300"},L={class:"border border-gray-300 p-2"},w={class:"border border-gray-300 p-2"},C={class:"border border-gray-300 p-2 capitalize"},T={class:"border border-gray-300 p-2"},A={class:"border border-gray-300 p-2"},B={key:3,class:"text-gray-500"},F={class:"mt-4 flex justify-between"},S=["disabled"],z=["disabled"],D=20,j=_({__name:"audit-log",setup(R){const c=n([]),d=n(!1),i=n(""),t=n(1),u=n(1);async function b(){d.value=!0,i.value="";try{const p=await $fetch("/api/audit/logs",{params:{page:t.value,pageSize:D},credentials:"include"});c.value=p.logs,u.value=p.totalPages}catch{i.value="Failed to load audit logs."}finally{d.value=!1}}function y(){t.value>1&&(t.value--,b())}function v(){t.value<u.value&&(t.value++,b())}return h(b),(p,l)=>(o(),r("div",x,[l[1]||(l[1]=e("h1",{class:"text-2xl font-bold mb-4"},"Audit Logs",-1)),l[2]||(l[2]=e("p",{class:"mb-6 text-gray-600"},"Track recent changes and actions by admins across the platform.",-1)),d.value?(o(),r("div",k,"Loading logs...")):g("",!0),i.value?(o(),r("div",N,a(i.value),1)):g("",!0),!d.value&&c.value.length?(o(),r("table",P,[l[0]||(l[0]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-gray-300 p-2"},"Timestamp"),e("th",{class:"border border-gray-300 p-2"},"Actor"),e("th",{class:"border border-gray-300 p-2"},"Role"),e("th",{class:"border border-gray-300 p-2"},"Action"),e("th",{class:"border border-gray-300 p-2"},"Target")])],-1)),e("tbody",null,[(o(!0),r(f,null,m(c.value,s=>(o(),r("tr",{key:s._id},[e("td",L,a(new Date(s.timestamp).toLocaleString()),1),e("td",w,a(s.actorName),1),e("td",C,a(s.actorRole.replace(/_/g," ")),1),e("td",T,a(s.action),1),e("td",A,a(s.targetType)+": "+a(s.targetName),1)]))),128))])])):g("",!0),!d.value&&!c.value.length?(o(),r("div",B,"No audit logs found.")):g("",!0),e("div",F,[e("button",{onClick:y,disabled:t.value===1,class:"px-3 py-1 bg-gray-300 rounded disabled:opacity-50"}," Previous ",8,S),e("div",null,"Page "+a(t.value)+" / "+a(u.value),1),e("button",{onClick:v,disabled:t.value===u.value,class:"px-3 py-1 bg-gray-300 rounded disabled:opacity-50"}," Next ",8,z)])]))}});export{j as default};
