import{g as N,D,r as n,y as S,c as t,a,t as r,k as y,d as m,m as b,v as x,l as T,p as V,n as z,o as s}from"./DQwChrcD.js";const I={class:"max-w-lg mx-auto p-8 bg-white rounded-lg shadow mt-12"},P={key:0,class:"text-center text-gray-600"},q={key:1},B={key:0,class:"text-red-600 text-center mb-4"},C={key:1},M={class:"mb-4 text-center"},A={key:0},E={key:1},R={key:0,class:"text-sm text-red-500 mb-2"},U=["disabled"],F=N({__name:"accept-invite",setup(Y){const h=D(),w=z(),p=h.query.token,g=n(""),l=n(""),d=n(""),v=n(!1),o=n(!1),c=n(""),i=n({email:"",role:"",organizationName:"",platformName:""}),k=async()=>{var u;if(!p){c.value="Invalid or missing invitation token.";return}o.value=!0;try{const e=await $fetch("/api/user/invite",{method:"GET",params:{token:p}});i.value=e.invitation}catch(e){c.value=((u=e==null?void 0:e.data)==null?void 0:u.message)||"Failed to load invitation."}finally{o.value=!1}},_=async()=>{var u;if(l.value.length<8){d.value="Password must be at least 8 characters long.",v.value=!1;return}o.value=!0;try{const e=await $fetch("/api/user/accept-invite",{method:"POST",body:{token:p,name:g.value.trim(),password:l.value.trim()}});v.value=e.success,d.value=e.message,e.success&&setTimeout(()=>{w.push("/login")},2e3)}catch(e){v.value=!1,d.value=((u=e==null?void 0:e.data)==null?void 0:u.message)||"Something went wrong."}finally{o.value=!1}};return S(k),(u,e)=>(s(),t("section",I,[e[6]||(e[6]=a("h1",{class:"text-3xl font-bold mb-4 text-center"},"Accept Invitation",-1)),o.value?(s(),t("div",P,"Loading invitation details...")):(s(),t("div",q,[c.value?(s(),t("div",B,r(c.value),1)):(s(),t("div",C,[a("p",M,[e[4]||(e[4]=m(" You've been invited as ")),a("strong",null,r(i.value.role),1),i.value.organizationName?(s(),t("span",A,[e[2]||(e[2]=m(" to ")),a("strong",null,r(i.value.organizationName),1)])):i.value.platformName?(s(),t("span",E,[e[3]||(e[3]=m(" to ")),a("strong",null,r(i.value.platformName),1)])):y("",!0),e[5]||(e[5]=m(". "))]),a("form",{onSubmit:T(_,["prevent"])},[b(a("input",{"onUpdate:modelValue":e[0]||(e[0]=f=>g.value=f),type:"text",placeholder:"Your Name",class:"input mb-3 w-full",required:""},null,512),[[x,g.value]]),b(a("input",{"onUpdate:modelValue":e[1]||(e[1]=f=>l.value=f),type:"password",placeholder:"Password",class:"input mb-3 w-full",required:""},null,512),[[x,l.value]]),l.value.length>0&&l.value.length<8?(s(),t("p",R," Password should be at least 8 characters long. ")):y("",!0),a("button",{disabled:o.value,type:"submit",class:"btn w-full"},r(o.value?"Submitting...":"Accept Invite"),9,U)],32),d.value?(s(),t("p",{key:0,class:V(["mt-4 text-center",{"text-green-600":v.value,"text-red-600":!v.value}])},r(d.value),3)):y("",!0)]))]))]))}});export{F as default};
