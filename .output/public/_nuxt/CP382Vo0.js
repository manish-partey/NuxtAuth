import{g as F,r as o,q as I,s as U,c as i,a as t,k as $,m as h,v as D,A as N,p as P,t as n,l as T,F as V,x as q,o as r}from"./DQwChrcD.js";import{u as A}from"./2qLusjlS.js";const E={class:"max-w-5xl mx-auto py-10 px-4"},M={key:0,class:"text-gray-600"},O={key:1,class:"text-red-600 font-semibold"},B={key:2,class:"space-y-4"},L={class:"flex justify-between items-center"},z={class:"text-gray-800 font-medium"},j={class:"space-x-2"},H=["onClick","disabled"],G=["onClick","disabled"],J={class:"text-sm text-gray-600"},K={class:"text-sm text-gray-500"},Q={class:"text-sm text-gray-500"},W={class:"text-sm text-gray-400"},X={class:"text-sm text-gray-600"},Y={key:3,class:"text-gray-600 italic"},se=F({__name:"invites",async setup(Z){var _;let v,f;const d=o([]),p=o(null),g=o(!0),c=o(null),m=o(null),a=o(""),u=o("success"),y=o(""),x=o("user");try{const{data:l,error:e}=([v,f]=I(()=>A("/api/org/invites",{headers:U(["cookie"])},"$UD_M3tc-dV")),v=await v,f(),v);e.value?p.value=e.value:(_=l.value)!=null&&_.invites&&(d.value=l.value.invites)}catch(l){p.value=l}finally{g.value=!1}function k(l){return new Date(l).toLocaleString()}async function w(l){a.value="",c.value=l;try{await $fetch("/api/org/invite/resend",{method:"POST",body:{inviteId:l}}),a.value="Invite resent successfully.",u.value="success"}catch{a.value="Failed to resend invite.",u.value="error"}finally{c.value=null}}async function C(l){m.value=l,a.value="";try{await $fetch("/api/org/invite/revoke",{method:"POST",body:{inviteId:l}}),a.value="Invite revoked successfully.",u.value="success",d.value=d.value.filter(e=>e._id!==l)}catch{a.value="Failed to revoke invite.",u.value="error"}finally{m.value=null}}async function S(){a.value="";try{await $fetch("/api/org/invite",{method:"POST",body:{email:y.value,role:x.value}}),a.value="Invite sent successfully.",u.value="success",y.value="",x.value="user"}catch(l){a.value="Failed to send invite.",u.value="error",console.error(l)}}return(l,e)=>(r(),i("div",E,[e[7]||(e[7]=t("h1",{class:"text-3xl font-semibold text-gray-800 mb-6"},"Pending Invitations",-1)),t("form",{onSubmit:T(S,["prevent"]),class:"mb-8 p-6 bg-white rounded-xl shadow space-y-4"},[e[5]||(e[5]=t("h2",{class:"text-xl font-bold text-gray-700"},"Invite New User",-1)),t("div",null,[e[2]||(e[2]=t("label",{for:"invite-email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),h(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>y.value=s),id:"invite-email",type:"email",class:"w-full border px-3 py-2 rounded",required:""},null,512),[[D,y.value]])]),t("div",null,[e[4]||(e[4]=t("label",{for:"invite-role",class:"block text-sm font-medium text-gray-700"},"Role",-1)),h(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),id:"invite-role",class:"w-full border px-3 py-2 rounded",required:""},e[3]||(e[3]=[t("option",{value:"user"},"User",-1)]),512),[[N,x.value]])]),e[6]||(e[6]=t("button",{type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Send Invite",-1)),a.value?(r(),i("p",{key:0,class:P([u.value==="success"?"text-green-600":"text-red-600","text-center font-medium"]),role:"alert"},n(a.value),3)):$("",!0)],32),g.value?(r(),i("div",M,"Loading invites...")):p.value?(r(),i("div",O," Failed to load invites. Please try again later. ")):d.value.length?(r(),i("div",B,[(r(!0),i(V,null,q(d.value,s=>{var b;return r(),i("div",{key:s._id,class:"p-4 bg-white rounded-xl shadow space-y-1"},[t("div",L,[t("p",z,n(s.email),1),t("div",j,[t("button",{onClick:R=>w(s._id),class:"text-blue-600 text-sm hover:underline",disabled:c.value===s._id},n(c.value===s._id?"Resending...":"Resend"),9,H),t("button",{onClick:R=>C(s._id),class:"text-red-600 text-sm hover:underline",disabled:m.value===s._id},n(m.value===s._id?"Revoking...":"Revoke"),9,G)])]),t("p",J,"Role: "+n(s.role),1),t("p",K,"Inviter: "+n(s.inviterName||"Unknown"),1),t("p",Q,"Status: "+n(s.status),1),t("p",W,"Created At: "+n(k(s.createdAt)),1),t("p",X,"Org: "+n(((b=s.organization)==null?void 0:b.name)||"-"),1)])}),128))])):(r(),i("div",Y,"No pending invitations."))]))}});export{se as default};
