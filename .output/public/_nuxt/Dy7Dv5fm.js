import{ad as d,j as h,ae as f,S as e}from"./DQwChrcD.js";const m=d(async r=>{var o,l;let s,n;const a=h();try{!a.user&&!a.loading&&([s,n]=f(()=>a.fetchUser()),await s,n())}catch(c){console.warn("[Auth Middleware] fetchUser failed:",c)}const u=["/","/login","/register","/forgot-password"].includes(r.path)||r.path.startsWith("/verify-email")||r.path.startsWith("/reset-password");if(!a.loggedIn&&!u)return e("/login");const t=(o=a.user)==null?void 0:o.role;if(r.path==="/dashboard")switch(t){case"user":return;case"super_admin":return e("/superadmin");case"platform_admin":return e("/platform");case"organization_admin":return e("/org");case"admin":return e("/admin");default:return e("/login")}const i=((l=r.meta)==null?void 0:l.roles)||[];if(i.length&&t&&!i.includes(t))return e("/login")});export{m as default};
